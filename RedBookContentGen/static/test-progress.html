<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¿›åº¦æ¡ç»„ä»¶æµ‹è¯•</title>
    <link rel="stylesheet" href="css/progress.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            padding: 40px 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 40px;
        }

        .test-controls {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 20px;
        }

        .test-controls h2 {
            font-size: 18px;
            color: #333;
            margin-bottom: 16px;
        }

        .button-group {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .test-button {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            background: #2196f3;
            color: white;
        }

        .test-button:hover {
            background: #1976d2;
        }

        .test-button.secondary {
            background: #f5f5f5;
            color: #666;
        }

        .test-button.secondary:hover {
            background: #e0e0e0;
        }

        .test-button.danger {
            background: #f44336;
            color: white;
        }

        .test-button.danger:hover {
            background: #d32f2f;
        }

        .test-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px;
            border-radius: 6px;
            margin-top: 16px;
            font-size: 13px;
            color: #1976d2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ è¿›åº¦æ¡ç»„ä»¶æµ‹è¯•</h1>

        <div class="test-controls">
            <h2>æµ‹è¯•æ§åˆ¶</h2>
            <div class="button-group">
                <button class="test-button" onclick="testSimpleProgress()">ç®€å•è¿›åº¦æµ‹è¯•</button>
                <button class="test-button" onclick="testStageProgress()">é˜¶æ®µè¿›åº¦æµ‹è¯•</button>
                <button class="test-button" onclick="testDetailProgress()">è¯¦ç»†è¿›åº¦æµ‹è¯•</button>
                <button class="test-button secondary" onclick="testComplete()">æ¨¡æ‹Ÿå®Œæˆ</button>
                <button class="test-button secondary" onclick="testFail()">æ¨¡æ‹Ÿå¤±è´¥</button>
                <button class="test-button danger" onclick="testCancel()">æ¨¡æ‹Ÿå–æ¶ˆ</button>
                <button class="test-button secondary" onclick="resetProgress()">é‡ç½®</button>
            </div>
            <div class="info-box">
                ğŸ’¡ æç¤ºï¼šç‚¹å‡»æŒ‰é’®æµ‹è¯•ä¸åŒçš„è¿›åº¦æ¡åŠŸèƒ½ã€‚è¿›åº¦æ¡æ”¯æŒå®æ—¶æ›´æ–°ã€é˜¶æ®µæ˜¾ç¤ºã€å‰©ä½™æ—¶é—´ä¼°ç®—ç­‰åŠŸèƒ½ã€‚
            </div>
        </div>

        <!-- è¿›åº¦æ¡å®¹å™¨ -->
        <div id="progress-container"></div>
    </div>

    <script src="js/progress.js"></script>
    <script>
        // åˆ›å»ºè¿›åº¦æ¡å®ä¾‹
        let progressBar;

        function initProgressBar() {
            progressBar = new ProgressBar('progress-container', {
                showStages: true,
                showTime: true,
                showDetails: true,
                allowCancel: true,
                autoHide: false
            });

            // è®¾ç½®å›è°ƒ
            progressBar.on('cancel', () => {
                console.log('ç”¨æˆ·å–æ¶ˆäº†æ“ä½œ');
                alert('æ“ä½œå·²å–æ¶ˆ');
            });

            progressBar.on('retry', () => {
                console.log('ç”¨æˆ·ç‚¹å‡»äº†é‡è¯•');
                testSimpleProgress();
            });

            progressBar.on('complete', () => {
                console.log('æ“ä½œå®Œæˆ');
            });
        }

        // ç®€å•è¿›åº¦æµ‹è¯•
        function testSimpleProgress() {
            progressBar.start();
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                progressBar.updateProgress(progress, {
                    status: 'generating_content',
                    statusText: `æ­£åœ¨ç”Ÿæˆ... ${progress}%`
                });

                if (progress >= 100) {
                    clearInterval(interval);
                    progressBar.complete('ç”Ÿæˆå®Œæˆï¼');
                }
            }, 200);
        }

        // é˜¶æ®µè¿›åº¦æµ‹è¯•
        function testStageProgress() {
            progressBar.start();
            
            // é˜¶æ®µ1ï¼šç”Ÿæˆæ–‡æ¡ˆ
            setTimeout(() => {
                progressBar.updateProgress(20, {
                    status: 'generating_content',
                    statusText: 'æ­£åœ¨ç”Ÿæˆæ–‡æ¡ˆ...',
                    stage: 'generating_content'
                });
            }, 500);

            setTimeout(() => {
                progressBar.updateProgress(40, {
                    statusText: 'æ–‡æ¡ˆç”Ÿæˆå®Œæˆ'
                });
            }, 1500);

            // é˜¶æ®µ2ï¼šç”Ÿæˆå›¾ç‰‡
            setTimeout(() => {
                progressBar.updateProgress(60, {
                    status: 'generating_image',
                    statusText: 'æ­£åœ¨ç”Ÿæˆå›¾ç‰‡...',
                    stage: 'generating_image'
                });
            }, 2000);

            setTimeout(() => {
                progressBar.updateProgress(80, {
                    statusText: 'å›¾ç‰‡ç”Ÿæˆä¸­...'
                });
            }, 3000);

            // å®Œæˆ
            setTimeout(() => {
                progressBar.updateProgress(100, {
                    stage: 'completed'
                });
                progressBar.complete('æ‰€æœ‰å†…å®¹ç”Ÿæˆå®Œæˆï¼');
            }, 4000);
        }

        // è¯¦ç»†è¿›åº¦æµ‹è¯•
        function testDetailProgress() {
            progressBar.start({
                details: {
                    current: 'å‡†å¤‡ç”Ÿæˆ',
                    completed: 0,
                    total: 5
                }
            });

            let completed = 0;
            const total = 5;
            const tasks = [
                'ç”Ÿæˆæ ‡é¢˜',
                'ç”Ÿæˆæ­£æ–‡',
                'ç”Ÿæˆæ ‡ç­¾',
                'ç”Ÿæˆå›¾ç‰‡æç¤ºè¯',
                'ç”Ÿæˆå›¾ç‰‡'
            ];

            const interval = setInterval(() => {
                if (completed < total) {
                    completed++;
                    const progress = (completed / total) * 100;
                    
                    progressBar.updateProgress(progress, {
                        status: completed <= 3 ? 'generating_content' : 'generating_image',
                        statusText: `æ­£åœ¨${tasks[completed - 1]}...`,
                        stage: completed <= 3 ? 'generating_content' : 'generating_image',
                        details: {
                            current: tasks[completed - 1],
                            completed: completed,
                            total: total
                        }
                    });
                } else {
                    clearInterval(interval);
                    progressBar.complete('æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼');
                }
            }, 1000);
        }

        // æ¨¡æ‹Ÿå®Œæˆ
        function testComplete() {
            progressBar.complete('æµ‹è¯•å®Œæˆï¼');
        }

        // æ¨¡æ‹Ÿå¤±è´¥
        function testFail() {
            progressBar.fail('ç”Ÿæˆå¤±è´¥ï¼šAPI è°ƒç”¨è¶…æ—¶');
        }

        // æ¨¡æ‹Ÿå–æ¶ˆ
        function testCancel() {
            progressBar.cancel();
        }

        // é‡ç½®
        function resetProgress() {
            progressBar.reset();
            progressBar.hide();
        }

        // åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            initProgressBar();
        });
    </script>
</body>
</html>
