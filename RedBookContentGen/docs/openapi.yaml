openapi: 3.0.3
info:
  title: RedBookContentGen API
  description: |
    è€åŒ—äº¬æ–‡åŒ–ä¸»é¢˜çš„å°çº¢ä¹¦å†…å®¹ç”Ÿæˆå·¥å…· API
    
    ## åŠŸèƒ½ç‰¹æ€§
    - ğŸ¤– AI æ–‡æ¡ˆç”Ÿæˆï¼šåŸºäºé€šä¹‰åƒé—®å¤§æ¨¡å‹ç”Ÿæˆå°çº¢ä¹¦é£æ ¼å†…å®¹
    - ğŸ¨ å›¾ç‰‡ç”Ÿæˆï¼šæ”¯æŒ API æ¨¡å¼ï¼ˆé€šä¹‰ä¸‡ç›¸ï¼‰å’Œæ¨¡æ¿æ¨¡å¼ï¼ˆç¦»çº¿ç”Ÿæˆï¼‰
    - ğŸ“¦ æ‰¹é‡å¤„ç†ï¼šæ”¯æŒæ‰¹é‡ç”Ÿæˆå†…å®¹å’Œå›¾ç‰‡
    - ğŸ“Š æ—¥å¿—æŸ¥è¯¢ï¼šå®æ—¶æŸ¥è¯¢å’Œç»Ÿè®¡åº”ç”¨æ—¥å¿—
    - ğŸ“¥ å¯¼å‡ºåŠŸèƒ½ï¼šæ”¯æŒ Excel å’Œ ZIP æ ¼å¼å¯¼å‡º
    
    ## è®¤è¯è¯´æ˜
    å½“å‰ç‰ˆæœ¬ä¸ºå•ç”¨æˆ·å·¥å…·ï¼Œæš‚ä¸éœ€è¦è®¤è¯ã€‚
    
    ## é€Ÿç‡é™åˆ¶
    - å†…å®¹ç”Ÿæˆï¼š60 æ¬¡/åˆ†é’Ÿ
    - å›¾ç‰‡ç”Ÿæˆï¼š10 æ¬¡/åˆ†é’Ÿ
    
    ## é”™è¯¯å¤„ç†
    æ‰€æœ‰é”™è¯¯å“åº”éµå¾ªç»Ÿä¸€æ ¼å¼ï¼ŒåŒ…å«é”™è¯¯ç ã€æ¶ˆæ¯å’Œä¿®å¤å»ºè®®ã€‚
    
  version: 1.0.0
  contact:
    name: RedBookContentGen é¡¹ç›®
  license:
    name: MIT

servers:
  - url: http://localhost:8080
    description: æœ¬åœ°å¼€å‘æœåŠ¡å™¨
  - url: http://localhost:8080/api
    description: API åŸºç¡€è·¯å¾„

tags:
  - name: å†…å®¹ç”Ÿæˆ
    description: å°çº¢ä¹¦å†…å®¹ç”Ÿæˆç›¸å…³æ¥å£
  - name: å›¾ç‰‡ç”Ÿæˆ
    description: å›¾ç‰‡ç”Ÿæˆå’Œä¸‹è½½ç›¸å…³æ¥å£
  - name: æ‰¹é‡å¤„ç†
    description: æ‰¹é‡ç”Ÿæˆå’Œå¯¼å‡ºç›¸å…³æ¥å£
  - name: æ—¥å¿—ç®¡ç†
    description: æ—¥å¿—æŸ¥è¯¢å’Œç»Ÿè®¡ç›¸å…³æ¥å£
  - name: ç³»ç»Ÿä¿¡æ¯
    description: ç³»ç»Ÿé…ç½®å’Œæ¨¡å‹ä¿¡æ¯

paths:
  /api/generate_content:
    post:
      tags:
        - å†…å®¹ç”Ÿæˆ
      summary: ç”Ÿæˆå°çº¢ä¹¦å†…å®¹
      description: |
        æ ¹æ®è¾“å…¥æ–‡æœ¬ç”Ÿæˆå°çº¢ä¹¦é£æ ¼çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€æ­£æ–‡ã€æ ‡ç­¾å’Œå›¾ç‰‡æç¤ºè¯ã€‚
        
        **åŠŸèƒ½è¯´æ˜**ï¼š
        - ä½¿ç”¨ AI å¤§æ¨¡å‹ç”Ÿæˆç¬¦åˆå°çº¢ä¹¦é£æ ¼çš„å†…å®¹
        - æ”¯æŒè‡ªå®šä¹‰ç”Ÿæˆæ•°é‡ï¼ˆæ ‡é¢˜æ•°é‡ï¼‰
        - è‡ªåŠ¨ç”Ÿæˆé…å¥—çš„å›¾ç‰‡æç¤ºè¯
        - æ”¯æŒç¼“å­˜æœºåˆ¶ï¼Œç›¸åŒè¾“å…¥è¿”å›ç¼“å­˜ç»“æœ
        
        **æ³¨æ„äº‹é¡¹**ï¼š
        - è¾“å…¥æ–‡æœ¬é•¿åº¦ï¼š10-5000 å­—ç¬¦
        - ç”Ÿæˆæ•°é‡ï¼š1-10 ä¸ªæ ‡é¢˜
        - å“åº”æ—¶é—´ï¼šé€šå¸¸ 2-5 ç§’
      operationId: generateContent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContentGenerationRequest'
            examples:
              basic:
                summary: åŸºç¡€ç¤ºä¾‹
                value:
                  input_text: "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯ã€‚æ¸…æ™¨çš„å«å–å£°ï¼Œå‚æ™šçš„ç‚ŠçƒŸï¼Œè¿˜æœ‰é‚£äº›é‚»é‡Œé—´çš„æ¸©æš–æ•…äº‹ã€‚"
                  count: 3
              detailed:
                summary: è¯¦ç»†ç¤ºä¾‹
                value:
                  input_text: "åŒ—äº¬çš„å››åˆé™¢æ˜¯ä¼ ç»Ÿå»ºç­‘çš„ä»£è¡¨ï¼Œä½“ç°äº†ä¸­å›½äººçš„å±…ä½æ™ºæ…§ã€‚é™¢è½å¸ƒå±€è®²ç©¶å¯¹ç§°ï¼Œä½“ç°äº†å¤©äººåˆä¸€çš„å“²å­¦æ€æƒ³ã€‚"
                  count: 5
                  style: "retro_chinese"
                  temperature: 0.8
      responses:
        '200':
          description: ç”ŸæˆæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ContentGenerationResponse'
              examples:
                success:
                  summary: æˆåŠŸå“åº”
                  value:
                    success: true
                    data:
                      titles:
                        - "ğŸ® è€åŒ—äº¬èƒ¡åŒé‡Œçš„æ¸©æš–è®°å¿†"
                        - "ğŸŒ† é‚£äº›å¹´ï¼Œèƒ¡åŒé‡Œçš„çƒŸç«æ°”"
                        - "ğŸ“– èƒ¡åŒæ·±å¤„çš„è€åŒ—äº¬æ•…äº‹"
                      content: "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯...\n\næ¸…æ™¨ï¼Œèƒ¡åŒé‡Œçš„å«å–å£°æ­¤èµ·å½¼ä¼..."
                      tags:
                        - "è€åŒ—äº¬"
                        - "èƒ¡åŒæ–‡åŒ–"
                        - "ç«¥å¹´å›å¿†"
                        - "ä¼ ç»Ÿæ–‡åŒ–"
                      image_prompts:
                        - "è€åŒ—äº¬èƒ¡åŒï¼Œæ¸…æ™¨é˜³å…‰ï¼Œå¤å¤è‰²è°ƒï¼Œæ¸©æš–æ°›å›´"
                        - "ä¼ ç»Ÿå››åˆé™¢ï¼Œçº¢ç¯ç¬¼ï¼Œé’ç –ç°ç“¦ï¼Œæ€€æ—§é£æ ¼"
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                validation_error:
                  summary: éªŒè¯é”™è¯¯
                  value:
                    success: false
                    error:
                      code: "VALIDATION_ERROR"
                      message: "è¾“å…¥æ•°æ®éªŒè¯å¤±è´¥"
                      errors:
                        - field: "input_text"
                          field_name: "è¾“å…¥æ–‡æœ¬"
                          message: "è¾“å…¥æ–‡æœ¬é•¿åº¦ä¸èƒ½å°‘äº 10 ä¸ªå­—ç¬¦ï¼ˆå½“å‰ï¼š5 ä¸ªå­—ç¬¦ï¼‰"
                          suggestions:
                            - "è¯·æä¾›æ›´è¯¦ç»†çš„å†…å®¹æè¿°"
                            - "å»ºè®®è‡³å°‘è¾“å…¥ 10 ä¸ªå­—ç¬¦"
                          error_type: "string_too_short"
                      total_errors: 1
        '500':
          description: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/batch/generate_content:
    post:
      tags:
        - æ‰¹é‡å¤„ç†
      summary: æ‰¹é‡ç”Ÿæˆå°çº¢ä¹¦å†…å®¹
      description: |
        æ‰¹é‡ç”Ÿæˆå¤šä¸ªå°çº¢ä¹¦å†…å®¹ï¼Œæ”¯æŒä¸€æ¬¡æ€§å¤„ç†å¤šä¸ªè¾“å…¥æ–‡æœ¬ã€‚
        
        **åŠŸèƒ½è¯´æ˜**ï¼š
        - æ”¯æŒæ‰¹é‡è¾“å…¥å¤šä¸ªæ–‡æœ¬ï¼ˆæœ€å¤š 50 æ¡ï¼‰
        - å¹¶è¡Œå¤„ç†ï¼Œæé«˜ç”Ÿæˆæ•ˆç‡
        - å•ä¸ªä»»åŠ¡å¤±è´¥ä¸å½±å“å…¶ä»–ä»»åŠ¡
        - è¿”å›è¯¦ç»†çš„æ‰¹æ¬¡ç»Ÿè®¡ä¿¡æ¯
        
        **æ³¨æ„äº‹é¡¹**ï¼š
        - æ‰¹é‡æ•°é‡ï¼š1-50 æ¡
        - æ¯æ¡è¾“å…¥æ–‡æœ¬é•¿åº¦ï¼š10-5000 å­—ç¬¦
        - å“åº”æ—¶é—´ï¼šå–å†³äºæ‰¹é‡æ•°é‡ï¼Œé€šå¸¸ 10-60 ç§’
      operationId: batchGenerateContent
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BatchContentGenerationRequest'
            examples:
              basic:
                summary: åŸºç¡€ç¤ºä¾‹
                value:
                  inputs:
                    - "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯..."
                    - "åŒ—äº¬çš„å››åˆé™¢æ˜¯ä¼ ç»Ÿå»ºç­‘çš„ä»£è¡¨ï¼Œä½“ç°äº†ä¸­å›½äººçš„å±…ä½æ™ºæ…§..."
                    - "è€åŒ—äº¬çš„å°åƒæ–‡åŒ–æºè¿œæµé•¿ï¼Œæ¯ä¸€ç§å°åƒéƒ½æœ‰è‡ªå·±çš„æ•…äº‹..."
                  count: 1
      responses:
        '200':
          description: æ‰¹é‡ç”ŸæˆæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BatchContentGenerationResponse'
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/generate_image:
    post:
      tags:
        - å›¾ç‰‡ç”Ÿæˆ
      summary: ç”Ÿæˆå•å¼ å›¾ç‰‡
      description: |
        æ ¹æ®æç¤ºè¯ç”Ÿæˆå›¾ç‰‡ï¼Œæ”¯æŒ API æ¨¡å¼å’Œæ¨¡æ¿æ¨¡å¼ã€‚
        
        **æ¨¡å¼è¯´æ˜**ï¼š
        - **API æ¨¡å¼**ï¼šä½¿ç”¨é€šä¹‰ä¸‡ç›¸ API ç”Ÿæˆ AI å›¾ç‰‡ï¼ˆéœ€è¦ API Keyï¼‰
        - **æ¨¡æ¿æ¨¡å¼**ï¼šä½¿ç”¨é¢„è®¾æ¨¡æ¿ç¦»çº¿ç”Ÿæˆå›¾ç‰‡ï¼ˆæ— éœ€ API Keyï¼Œæ¨èï¼‰
        
        **æ¨¡æ¿é£æ ¼**ï¼š
        - retro_chineseï¼šå¤å¤ä¸­å›½é£
        - modern_minimalï¼šç°ä»£ç®€çº¦
        - vintage_filmï¼šæ€€æ—§èƒ¶ç‰‡
        - warm_memoryï¼šæ¸©æš–è®°å¿†
        - ink_washï¼šæ°´å¢¨é£æ ¼
        
        **æ³¨æ„äº‹é¡¹**ï¼š
        - API æ¨¡å¼å“åº”æ—¶é—´ï¼š30-120 ç§’
        - æ¨¡æ¿æ¨¡å¼å“åº”æ—¶é—´ï¼š< 1 ç§’
        - å›¾ç‰‡å°ºå¯¸ï¼šverticalï¼ˆç«–ç‰ˆï¼‰ã€horizontalï¼ˆæ¨ªç‰ˆï¼‰ã€squareï¼ˆæ–¹å½¢ï¼‰
      operationId: generateImage
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImageGenerationRequest'
            examples:
              template_mode:
                summary: æ¨¡æ¿æ¨¡å¼ï¼ˆæ¨èï¼‰
                value:
                  prompt: "è€åŒ—äº¬èƒ¡åŒï¼Œå¤å¤é£æ ¼ï¼Œæ¸©æš–çš„é˜³å…‰"
                  image_mode: "template"
                  template_style: "retro_chinese"
                  image_size: "vertical"
                  title: "è€åŒ—äº¬çš„è®°å¿†"
                  scene: "å¤•é˜³ä¸‹çš„èƒ¡åŒ"
                  content_text: "è®°å¾—å°æ—¶å€™..."
                  task_id: "task_20260213_001"
                  timestamp: "20260213_143000"
                  task_index: 0
                  image_type: "content"
              api_mode:
                summary: API æ¨¡å¼
                value:
                  prompt: "è€åŒ—äº¬èƒ¡åŒï¼Œå¤å¤é£æ ¼ï¼Œæ¸©æš–çš„é˜³å…‰"
                  image_mode: "api"
                  image_model: "wanx-v1"
                  image_size: "vertical"
                  task_id: "task_20260213_001"
                  timestamp: "20260213_143000"
                  task_index: 0
      responses:
        '200':
          description: ç”ŸæˆæˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImageGenerationResponse'
              examples:
                success:
                  summary: æˆåŠŸå“åº”
                  value:
                    success: true
                    data:
                      image_url: "/api/download/images/20260213/image_001.png"
                      task_id: "task_20260213_001"
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/download/{filename}:
    get:
      tags:
        - å›¾ç‰‡ç”Ÿæˆ
      summary: ä¸‹è½½ç”Ÿæˆçš„å›¾ç‰‡
      description: ä¸‹è½½æŒ‡å®šçš„å›¾ç‰‡æ–‡ä»¶
      operationId: downloadImage
      parameters:
        - name: filename
          in: path
          required: true
          description: å›¾ç‰‡æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºè¾“å‡ºç›®å½•ï¼‰
          schema:
            type: string
          example: "images/20260213/image_001.png"
      responses:
        '200':
          description: æ–‡ä»¶ä¸‹è½½æˆåŠŸ
          content:
            image/png:
              schema:
                type: string
                format: binary
            image/jpeg:
              schema:
                type: string
                format: binary
        '404':
          description: æ–‡ä»¶ä¸å­˜åœ¨
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/models:
    get:
      tags:
        - ç³»ç»Ÿä¿¡æ¯
      summary: è·å–å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨
      description: è·å–ç³»ç»Ÿæ”¯æŒçš„å›¾ç‰‡ç”Ÿæˆæ¨¡å‹å’Œå°ºå¯¸é…ç½®
      operationId: getModels
      responses:
        '200':
          description: æˆåŠŸè·å–æ¨¡å‹åˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  models:
                    type: array
                    items:
                      type: string
                    example: ["wanx-v1", "wanx2.2-t2i-flash"]
                  image_sizes:
                    type: object
                    additionalProperties:
                      type: string
                    example:
                      vertical: "1024*1365"
                      horizontal: "1365*1024"
                      square: "1024*1024"

  /api/search:
    get:
      tags:
        - ç³»ç»Ÿä¿¡æ¯
      summary: é€šç”¨æœç´¢æ¥å£
      description: |
        é€šç”¨æœç´¢æ¥å£ï¼Œæ”¯æŒå…³é”®è¯æœç´¢ã€æ—¶é—´èŒƒå›´è¿‡æ»¤å’Œåˆ†é¡µã€‚
        
        **æ³¨æ„**ï¼š
        - å½“å‰è¿”å›ç©ºç»“æœ
        - å®é™…æœç´¢åŠŸèƒ½éœ€è¦åœ¨å®ç°å†å²è®°å½•ã€æ¨¡æ¿ç®¡ç†ç­‰åŠŸèƒ½åé›†æˆ
      operationId: search
      parameters:
        - name: page
          in: query
          description: é¡µç 
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 50
        - name: keyword
          in: query
          description: æœç´¢å…³é”®è¯
          schema:
            type: string
        - name: start_time
          in: query
          description: å¼€å§‹æ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰
          schema:
            type: string
            format: date-time
          example: "2026-02-13T00:00:00"
        - name: end_time
          in: query
          description: ç»“æŸæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰
          schema:
            type: string
            format: date-time
          example: "2026-02-14T23:59:59"
        - name: sort_by
          in: query
          description: æ’åºå­—æ®µ
          schema:
            type: string
            default: "created_at"
        - name: sort_order
          in: query
          description: æ’åºé¡ºåº
          schema:
            type: string
            enum: [asc, desc]
            default: "desc"
      responses:
        '200':
          description: æœç´¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchResponse'

  /api/logs/search:
    get:
      tags:
        - æ—¥å¿—ç®¡ç†
      summary: æœç´¢æ—¥å¿—
      description: |
        æ ¹æ®æ¡ä»¶æœç´¢åº”ç”¨æ—¥å¿—ï¼Œæ”¯æŒå¤šç§è¿‡æ»¤æ¡ä»¶ã€‚
        
        **è¿‡æ»¤æ¡ä»¶**ï¼š
        - æ—¥å¿—çº§åˆ«ï¼šDEBUGã€INFOã€WARNINGã€ERRORã€CRITICAL
        - æ—¥å¿—æ¥æºï¼šæ¨¡å—åç§°
        - æ—¶é—´èŒƒå›´ï¼šå¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´
        - å…³é”®è¯ï¼šåœ¨æ—¥å¿—æ¶ˆæ¯ä¸­æœç´¢
      operationId: searchLogs
      parameters:
        - name: page
          in: query
          description: é¡µç 
          schema:
            type: integer
            minimum: 1
            default: 1
        - name: page_size
          in: query
          description: æ¯é¡µæ•°é‡
          schema:
            type: integer
            minimum: 1
            maximum: 200
            default: 50
        - name: level
          in: query
          description: æ—¥å¿—çº§åˆ«
          schema:
            type: string
            enum: [DEBUG, INFO, WARNING, ERROR, CRITICAL]
        - name: logger
          in: query
          description: æ—¥å¿—æ¥æºï¼ˆæ¨¡å—åç§°ï¼‰
          schema:
            type: string
        - name: start_time
          in: query
          description: å¼€å§‹æ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰
          schema:
            type: string
            format: date-time
        - name: end_time
          in: query
          description: ç»“æŸæ—¶é—´ï¼ˆISO 8601 æ ¼å¼ï¼‰
          schema:
            type: string
            format: date-time
        - name: keyword
          in: query
          description: æœç´¢å…³é”®è¯
          schema:
            type: string
      responses:
        '200':
          description: æœç´¢æˆåŠŸ
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LogSearchResponse'

  /api/logs/stats:
    get:
      tags:
        - æ—¥å¿—ç®¡ç†
      summary: è·å–æ—¥å¿—ç»Ÿè®¡ä¿¡æ¯
      description: è·å–æ—¥å¿—çš„ç»Ÿè®¡æ•°æ®ï¼ŒåŒ…æ‹¬æ€»æ•°ã€é”™è¯¯æ•°ã€è­¦å‘Šæ•°ç­‰
      operationId: getLogStats
      responses:
        '200':
          description: æˆåŠŸè·å–ç»Ÿè®¡ä¿¡æ¯
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  stats:
                    type: object
                    properties:
                      total:
                        type: integer
                        description: æ€»æ—¥å¿—æ•°
                        example: 1234
                      error:
                        type: integer
                        description: é”™è¯¯æ—¥å¿—æ•°
                        example: 12
                      warning:
                        type: integer
                        description: è­¦å‘Šæ—¥å¿—æ•°
                        example: 45
                      today:
                        type: integer
                        description: ä»Šæ—¥æ—¥å¿—æ•°
                        example: 156

  /api/logs/loggers:
    get:
      tags:
        - æ—¥å¿—ç®¡ç†
      summary: è·å–æ‰€æœ‰æ—¥å¿—æ¥æºåˆ—è¡¨
      description: è·å–ç³»ç»Ÿä¸­æ‰€æœ‰çš„æ—¥å¿—æ¥æºï¼ˆæ¨¡å—åç§°ï¼‰åˆ—è¡¨
      operationId: getLoggers
      responses:
        '200':
          description: æˆåŠŸè·å–æ—¥å¿—æ¥æºåˆ—è¡¨
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  loggers:
                    type: array
                    items:
                      type: string
                    example: ["web_app", "content_generator", "image_generator"]

  /api/batch/export/excel:
    post:
      tags:
        - æ‰¹é‡å¤„ç†
      summary: å¯¼å‡ºæ‰¹é‡ç»“æœä¸º Excel
      description: |
        å°†æ‰¹é‡ç”Ÿæˆç»“æœå¯¼å‡ºä¸º Excel æ–‡ä»¶ã€‚
        
        **æ–‡ä»¶å†…å®¹**ï¼š
        - æ‰¹æ¬¡æ±‡æ€»ä¿¡æ¯
        - æ¯ä¸ªä»»åŠ¡çš„è¯¦ç»†ç»“æœ
        - æˆåŠŸ/å¤±è´¥ç»Ÿè®¡
        
        **æ³¨æ„**ï¼šéœ€è¦å®‰è£… openpyxl åº“
      operationId: exportBatchExcel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                batch_result:
                  $ref: '#/components/schemas/BatchContentGenerationResponse'
      responses:
        '200':
          description: å¯¼å‡ºæˆåŠŸ
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: å¯¼å‡ºå¤±è´¥
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/batch/export/zip:
    post:
      tags:
        - æ‰¹é‡å¤„ç†
      summary: å¯¼å‡ºæ‰¹é‡ç»“æœä¸º ZIP
      description: |
        å°†æ‰¹é‡ç”Ÿæˆç»“æœæ‰“åŒ…ä¸º ZIP æ–‡ä»¶ã€‚
        
        **åŒ…å«å†…å®¹**ï¼š
        - Excel æ±‡æ€»æ–‡ä»¶ï¼ˆå¦‚æœ openpyxl å¯ç”¨ï¼‰
        - æ‰¹æ¬¡ä¿¡æ¯æ–‡æœ¬æ–‡ä»¶
        - æ‰€æœ‰ç”Ÿæˆçš„å›¾ç‰‡æ–‡ä»¶
      operationId: exportBatchZip
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                batch_result:
                  $ref: '#/components/schemas/BatchContentGenerationResponse'
      responses:
        '200':
          description: å¯¼å‡ºæˆåŠŸ
          content:
            application/zip:
              schema:
                type: string
                format: binary
        '400':
          description: è¯·æ±‚å‚æ•°é”™è¯¯
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    ContentGenerationRequest:
      type: object
      required:
        - input_text
      properties:
        input_text:
          type: string
          minLength: 10
          maxLength: 5000
          description: è¾“å…¥æ–‡æœ¬ï¼Œç”¨äºç”Ÿæˆå°çº¢ä¹¦å†…å®¹
          example: "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯ã€‚æ¸…æ™¨çš„å«å–å£°ï¼Œå‚æ™šçš„ç‚ŠçƒŸï¼Œè¿˜æœ‰é‚£äº›é‚»é‡Œé—´çš„æ¸©æš–æ•…äº‹ã€‚"
        count:
          type: integer
          minimum: 1
          maximum: 10
          default: 3
          description: ç”Ÿæˆæ ‡é¢˜çš„æ•°é‡
          example: 3
        style:
          type: string
          default: "retro_chinese"
          description: ç”Ÿæˆé£æ ¼ï¼ˆä¿ç•™å­—æ®µï¼Œæš‚æœªä½¿ç”¨ï¼‰
          example: "retro_chinese"
        temperature:
          type: number
          minimum: 0.0
          maximum: 2.0
          default: 0.8
          description: ç”Ÿæˆæ¸©åº¦ï¼ˆä¿ç•™å­—æ®µï¼Œæš‚æœªä½¿ç”¨ï¼‰
          example: 0.8

    ContentGenerationResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            titles:
              type: array
              items:
                type: string
              description: ç”Ÿæˆçš„æ ‡é¢˜åˆ—è¡¨
              example:
                - "ğŸ® è€åŒ—äº¬èƒ¡åŒé‡Œçš„æ¸©æš–è®°å¿†"
                - "ğŸŒ† é‚£äº›å¹´ï¼Œèƒ¡åŒé‡Œçš„çƒŸç«æ°”"
            content:
              type: string
              description: ç”Ÿæˆçš„æ­£æ–‡å†…å®¹
              example: "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯..."
            tags:
              type: array
              items:
                type: string
              description: ç”Ÿæˆçš„æ ‡ç­¾åˆ—è¡¨
              example: ["è€åŒ—äº¬", "èƒ¡åŒæ–‡åŒ–", "ç«¥å¹´å›å¿†"]
            image_prompts:
              type: array
              items:
                type: string
              description: å›¾ç‰‡æç¤ºè¯åˆ—è¡¨
              example: ["è€åŒ—äº¬èƒ¡åŒï¼Œæ¸…æ™¨é˜³å…‰ï¼Œå¤å¤è‰²è°ƒ"]

    BatchContentGenerationRequest:
      type: object
      required:
        - inputs
      properties:
        inputs:
          type: array
          items:
            type: string
            minLength: 10
            maxLength: 5000
          minItems: 1
          maxItems: 50
          description: æ‰¹é‡è¾“å…¥æ–‡æœ¬åˆ—è¡¨
          example:
            - "è®°å¾—å°æ—¶å€™ï¼Œè€åŒ—äº¬çš„èƒ¡åŒé‡Œæ€»æ˜¯å……æ»¡äº†ç”Ÿæ´»çš„æ°”æ¯..."
            - "åŒ—äº¬çš„å››åˆé™¢æ˜¯ä¼ ç»Ÿå»ºç­‘çš„ä»£è¡¨..."
        count:
          type: integer
          minimum: 1
          maximum: 10
          default: 1
          description: æ¯ä¸ªè¾“å…¥ç”Ÿæˆçš„æ ‡é¢˜æ•°é‡
          example: 1

    BatchContentGenerationResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            batch_id:
              type: string
              description: æ‰¹æ¬¡ ID
              example: "batch_20260213_143000"
            total:
              type: integer
              description: æ€»ä»»åŠ¡æ•°
              example: 3
            results:
              type: array
              items:
                type: object
                properties:
                  index:
                    type: integer
                    description: ä»»åŠ¡ç´¢å¼•
                  input_text:
                    type: string
                    description: è¾“å…¥æ–‡æœ¬
                  status:
                    type: string
                    enum: [success, failed]
                    description: ä»»åŠ¡çŠ¶æ€
                  data:
                    type: object
                    description: ç”Ÿæˆç»“æœï¼ˆæˆåŠŸæ—¶ï¼‰
                  error:
                    type: string
                    description: é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶ï¼‰
            summary:
              type: object
              properties:
                success:
                  type: integer
                  description: æˆåŠŸæ•°é‡
                failed:
                  type: integer
                  description: å¤±è´¥æ•°é‡
                total:
                  type: integer
                  description: æ€»æ•°é‡

    ImageGenerationRequest:
      type: object
      required:
        - prompt
        - task_id
        - timestamp
      properties:
        prompt:
          type: string
          minLength: 1
          maxLength: 1000
          description: å›¾ç‰‡ç”Ÿæˆæç¤ºè¯
          example: "è€åŒ—äº¬èƒ¡åŒï¼Œå¤å¤é£æ ¼ï¼Œæ¸©æš–çš„é˜³å…‰"
        image_mode:
          type: string
          enum: [api, template]
          default: "template"
          description: å›¾ç‰‡ç”Ÿæˆæ¨¡å¼
          example: "template"
        image_model:
          type: string
          default: "wanx-v1"
          description: å›¾ç‰‡ç”Ÿæˆæ¨¡å‹ï¼ˆAPI æ¨¡å¼ï¼‰
          example: "wanx-v1"
        template_style:
          type: string
          enum: [retro_chinese, modern_minimal, vintage_film, warm_memory, ink_wash]
          default: "retro_chinese"
          description: æ¨¡æ¿é£æ ¼ï¼ˆæ¨¡æ¿æ¨¡å¼ï¼‰
          example: "retro_chinese"
        image_size:
          type: string
          enum: [vertical, horizontal, square]
          default: "vertical"
          description: å›¾ç‰‡å°ºå¯¸
          example: "vertical"
        title:
          type: string
          description: å›¾ç‰‡æ ‡é¢˜ï¼ˆæ¨¡æ¿æ¨¡å¼ï¼‰
          example: "è€åŒ—äº¬çš„è®°å¿†"
        scene:
          type: string
          description: åœºæ™¯æè¿°ï¼ˆæ¨¡æ¿æ¨¡å¼ï¼‰
          example: "å¤•é˜³ä¸‹çš„èƒ¡åŒ"
        content_text:
          type: string
          description: å†…å®¹æ–‡æœ¬ï¼ˆæ¨¡æ¿æ¨¡å¼ï¼‰
          example: "è®°å¾—å°æ—¶å€™..."
        task_id:
          type: string
          description: ä»»åŠ¡ ID
          example: "task_20260213_001"
        timestamp:
          type: string
          pattern: '^\d{8}_\d{6}$'
          description: æ—¶é—´æˆ³ï¼ˆæ ¼å¼ï¼šYYYYMMDD_HHMMSSï¼‰
          example: "20260213_143000"
        task_index:
          type: integer
          minimum: 0
          default: 0
          description: ä»»åŠ¡ç´¢å¼•
          example: 0
        image_type:
          type: string
          enum: [content, cover]
          default: "content"
          description: å›¾ç‰‡ç±»å‹
          example: "content"

    ImageGenerationResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            image_url:
              type: string
              description: å›¾ç‰‡ä¸‹è½½ URL
              example: "/api/download/images/20260213/image_001.png"
            task_id:
              type: string
              description: ä»»åŠ¡ ID
              example: "task_20260213_001"

    SearchResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        data:
          type: object
          properties:
            items:
              type: array
              items:
                type: object
              description: æœç´¢ç»“æœåˆ—è¡¨
            total:
              type: integer
              description: æ€»ç»“æœæ•°
            page:
              type: integer
              description: å½“å‰é¡µç 
            page_size:
              type: integer
              description: æ¯é¡µæ•°é‡
            total_pages:
              type: integer
              description: æ€»é¡µæ•°
        query:
          type: object
          description: æŸ¥è¯¢å‚æ•°

    LogSearchResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        logs:
          type: array
          items:
            type: object
            properties:
              timestamp:
                type: string
                format: date-time
                description: æ—¥å¿—æ—¶é—´
              level:
                type: string
                description: æ—¥å¿—çº§åˆ«
              logger:
                type: string
                description: æ—¥å¿—æ¥æº
              message:
                type: string
                description: æ—¥å¿—æ¶ˆæ¯
              context:
                type: object
                description: æ—¥å¿—ä¸Šä¸‹æ–‡
        total:
          type: integer
          description: æ€»æ—¥å¿—æ•°
        page:
          type: integer
          description: å½“å‰é¡µç 
        page_size:
          type: integer
          description: æ¯é¡µæ•°é‡

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
              description: é”™è¯¯ç 
              example: "VALIDATION_ERROR"
            message:
              type: string
              description: é”™è¯¯æ¶ˆæ¯
              example: "è¾“å…¥æ•°æ®éªŒè¯å¤±è´¥"
            errors:
              type: array
              items:
                type: object
                properties:
                  field:
                    type: string
                    description: é”™è¯¯å­—æ®µ
                  field_name:
                    type: string
                    description: å­—æ®µä¸­æ–‡åç§°
                  message:
                    type: string
                    description: é”™è¯¯è¯¦æƒ…
                  suggestions:
                    type: array
                    items:
                      type: string
                    description: ä¿®å¤å»ºè®®
                  error_type:
                    type: string
                    description: é”™è¯¯ç±»å‹
            total_errors:
              type: integer
              description: é”™è¯¯æ€»æ•°
