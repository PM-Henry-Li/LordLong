# 绩效分析脚本

## 简介

这是一个基于FY26Q3绩效数据的分析脚本，用于快速查询和分析员工的绩效表现。

## 功能特性

- ✅ **个人分析**：输入员工姓名，输出详细的绩效分析报告
- ✅ **车厢分析**：输入车厢名称，输出车厢整体绩效和成员分析
- ✅ 支持命令行参数和交互式两种模式
- ✅ 提供5个维度的详细数据分析
- ✅ 自动对比车厢/全公司平均水平
- ✅ 智能生成优势分析和改进建议
- ✅ 友好的错误提示和姓名模糊匹配

## 环境要求

- Python 3.7+
- pandas
- openpyxl

## 安装依赖

```bash
pip install pandas openpyxl
```

## 使用方法

### 1. 个人绩效分析

#### 基本用法（推荐）

```bash
python performance_analyzer.py 丁星杰
```

#### 指定Excel文件路径

```bash
python performance_analyzer.py --file baseInfo/FY26Q3-汇总版-v1.xlsx 丁星杰
```

### 2. 车厢绩效分析

#### 基本用法

```bash
python performance_analyzer.py --team 站内营销
```

或使用简写：

```bash
python performance_analyzer.py -t 三教服务
```

#### 指定Excel文件路径

```bash
python performance_analyzer.py --file baseInfo/FY26Q3-汇总版-v1.xlsx --team 站内营销
```

### 3. 交互式模式

```bash
# 个人分析交互模式
python performance_analyzer.py
# 然后按提示输入员工姓名

# 车厢分析交互模式
python performance_analyzer.py --team
# 然后按提示输入车厢名称
```

### 4. 查看帮助

```bash
python performance_analyzer.py --help
```

## 输出说明

### 个人绩效分析报告

分析报告包含以下内容：

#### 📋 基本信息
- 姓名、车厢、是否车厢长、归属实体

### 🎯 总体绩效
- 总分（满分10分）
- 团队排名（第X名/共Y人）
- 绩效评价（优秀/良好/中等/待提升）

### 📊 各维度详细得分

1. **OHT执行（30%）**
   - 车厢得分、站台得分
   - 车厢分位、站台分位

2. **OHT保障（10%）**
   - 线上故障、线上BUG
   - 技术工单、漏洞超期、系统两用分

3. **影响力（10%）**
   - 自评、同事评价、他评

4. **努力度（10%）**
   - 平均工时、连续得分

5. **系统价值分（5%）**
   - 所属车厢、换算分数

### 📈 车厢对比
- 个人得分 vs 车厢平均分
- 各维度对比分析

### 💡 优势与建议
- 优势维度识别
- 改进空间分析
- 个性化建议

### 车厢绩效分析报告

车厢分析报告包含以下内容：

#### 🚂 车厢基本信息
- 车厢名称、成员人数、车厢长

#### 📊 车厢总体表现
- 平均总分、平均排名
- 与全公司对比
- 车厢排名（在所有车厢中的位置）

#### 📈 各维度平均得分
- 5个维度的车厢平均分
- 与全公司平均水平对比

#### 👥 成员排名分布
- 前10%、前30%、前50%的成员数量和占比

#### 🏆 车厢Top 3成员
- 车厢内绩效最好的3名成员

#### 🔍 需要关注的成员
- 排名后30%的成员列表

#### 💡 车厢优势与改进建议
- 优势维度和薄弱维度分析
- 针对车厢的改进建议

## 示例输出

```
======================================================================
📋 绩效分析报告 - 丁星杰
======================================================================

【基本信息】
  姓名：丁星杰
  车厢：站内营销
  是否车厢长：否
  归属实体：FE

【总体绩效】
  总分：8.72 分
  排名：第 29 名 / 共 56 人
  评价：👍 中等偏上（前50%）

【各维度得分】
  ...（详细维度信息）

【与车厢平均对比】
  OHT执行30%：个人 8.69 vs 车厢 7.93 📈 +0.76
  ...

【优势与建议】
  💪 优势维度：影响力10%、价值分5%
  📈 改进空间：努力度10%
  💡 总体建议：表现良好，重点关注得分较低的维度...
======================================================================
```

## 常见问题

### Q: 提示找不到员工怎么办？
A: 请确认姓名拼写正确。如果姓名中包含相似字符，脚本会给出建议。

### Q: 能否批量分析多个员工？
A: 当前版本仅支持单个员工查询，批量分析可通过shell脚本循环调用实现。

### Q: 数据来源是哪里？
A: 数据来源于`baseInfo/FY26Q3-汇总版-v1.xlsx`文件，包含9个Sheet页的完整绩效数据。

## 技术架构

```
performance_analyzer.py
├── PerformanceAnalyzer 类
│   ├── _load_data()          # 加载Excel数据
│   ├── find_person()          # 查找员工
│   ├── analyze_person()       # 绩效分析
│   ├── _add_dimension_details() # 维度详情
│   ├── _add_team_comparison()   # 车厢对比
│   └── _add_suggestions()       # 建议生成
└── main()                     # 命令行入口
```

## 许可证

内部使用工具

## 版本历史

- v1.0 (2026-02-04) - 初始版本，支持FY26Q3数据分析
